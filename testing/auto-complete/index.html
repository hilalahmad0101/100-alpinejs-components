<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../output.css" rel="stylesheet" />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
  </head>
  <body
    class="bg-gray-100"
    x-data="{
        selectedIndex:-1,
    query:null,
    users:[
    'hilal',
    'ahmad',
    'bilal',
    'hazrat',
    'ali',
    'zia',
    'waqas',
    'hasaan'
    ],

    fetchResults(){
        if(this.query.length != 0){
            let new_users= this.users.filter(user => user.toLowerCase().includes(this.query.toLowerCase()));
            this.users= new_users;
            let selectedIndex = this.users.findIndex(user => user.toLowerCase() === this.query.toLowerCase());
            // If no exact match, set selectedIndex to 0

            this.selectedIndex = selectedIndex !== -1 ? selectedIndex + 1 : 0;
        }else{
            this.users=[
            'hilal',
            'ahmad',
            'bilal',
            'hazrat',
            'ali',
            'zia',
            'waqas',
            'hasaan'
            ]
        }
    },
    userSelect(index){
        this.query=this.users[index];
        this.users=[];
    }
  }"
  >
    <h1 class="text-center text-4xl font-bold my-10">Auto Complete</h1>

    <div class="container mx-auto max-w-3xl relative">
      <div class="bg-white py-4 px-4 rounded-md">
        <input
          type="text"
          x-model="query"
          @input="fetchResults"
          placeholder="Search For user"
          class="w-full py-2 border outline-none px-4 rounded-md"
        />
      </div>
      <div class="absolute top-20 w-full" :class="query ? 'block':'hidden'">
        <template x-for="(user,index) in users">
          <div class="bg-white">
            <h1
              :class="selectedIndex == index ? 'bg-blue-500':'bg-white'"
              class="text-base px-4 hover:text-white font-semibold py-1 hover:bg-blue-400 cursor-pointer"
              @click="userSelect(index)"
              x-text="user"
            ></h1>
          </div>
        </template>
      </div>
    </div>
  </body>
</html>
